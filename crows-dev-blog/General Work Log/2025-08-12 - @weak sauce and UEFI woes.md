#####  August 12th, 2025, ca. 14:00 -0400
## Active Projects: this site, [xmit.xyz](https://xmit.xyz/), and [uefi.c3l](https://github.com/NotsoanoNimus/uefi.c3l)
> [!info]- Article PGP Signature
>
> To verify this signature, use the public key on the [[Hello, World!|Home Page]].
>
> ```
> -----BEGIN PGP MESSAGE-----
>
> owGFWE2MHEcVXgdzcKOIXGJOiOf1wbNmfkgWrGTNxj/rdTzSem3ZaxzFCjPV3dXT
> le2umlRV7+yYcONAJA4IiQPihEBCSOHAhQiJExJcLKQcuOSAkLhY4sgBJRIgvlfV
> s2t7jX3YnZ76eb/f+97r+eGLn1tKTr7y4S//9J9P3tHHfv3FT9PEqYmuZd/v+/Kn
> //jg9OnTdGfz6pBuWvOuzHwyPLMnKZVS08zYXaUnZDQJnZMpCn6s52Rmmu69uX2n
> x/eEFpWZvNMpvZ+6tcFgonzZpP3M1INt450R2myrunGDRhaqn61WK5Q2qvIk97Oq
> cWpPVnNSELixeigkW+1VQk/6xk4GK92gvlJ6V+bkDVnpmsqzZUH/dFqpTHhltKMZ
> lJPAWe8rSaWsplRYU5NpLB6UhJxxxpLHfRqeqSpypZmRL2UUbwlm16xNuOA+O+xL
> 5Wgao8OfE+h30nUREBxvrJNdckpnkpSn3EhHvK+9EhU80wb3YapVk9Lj26yfJJe8
> l/U0eBDcyawUXtJoojlGIyqhPWSgR1rKvII8PujEHCuCshKSpZ5IcoYKYfu0U0or
> SeCv5shM4XvQ6g5yKCZCaeeplrAZD0L7ar6W9Ohue6CNnJaz6KOoa17mWDViIhOC
> 6tF1KXSw+kDfe42C5YIK3EubSbAzBq7x5LxCiDmcQwjeQ3h3EQCahds4ODVKewZU
> AaHYLYzF6TlNAApNyrlGjmDiNmLQxgqGT+RBvnjRyamwiB5CHTLNe0jiVFUBEpwk
> XjIpp89B2lVjg2ctjpXO5RS4QMJoWdishD+Zb6xcDobbBolE0Ni0O0fgBosaJyH0
> 8YzCKzlho2hj9Yxjo3UuLEM4tcIy2nGIrarVfpKc5hK8OJNiN9nERRt2CmWRLbZg
> alUdLnE4Fu7kYr4WHsbh4pjcvE5N1Y/SIA+qBs7nA3xm4R8qLxmPx1lSm7ypOH5p
> RhdV0ZF6b21t+8Zoa3h5Y+V8MhhQv99PCk17RuVnqQbWTNZp3H2A/L5ciZbSRbkP
> U3VnOe4vY10b562aJt9JTjQaiAZM00ouTlCjxZ5AVrC2DD3fPVSRHapAPWnfpf+r
> LXuutux52gorZSc8HpHOW8srR0Ty8jME4mSwP36bevsM+9uzz3KgPXJUIbKXJKBU
> lcUKEB7308bLgENeCRxzgdnAxeq8F7TnEpRnI2QPKVbq/kztqilqSwSe5W+Du7gw
> imBaCaCX+1PUA4h3xIgZgUBqAzQWjc5ayi1VVrIxXACHVQ17aiervWidYcagGAWm
> xV4OotOQGlWB7ubBAydQaxr/gOQd5t0ajONIFTRnClc1qK1GqcbaZp5U3oU6HkeY
> jbsg+MWT9FmfHTAWmIJ4zQwNxm8qdDPQ0cwyefkQroUhzRSCW3KBEdfMjImrG25K
> uBRLelF2BzlAeeozoT1MpQUXTYVzkSlj88CqB+EsCn8itWSCQDuagYHMzPX2z319
> TF7YieTWKLPGc+qZ2yEhE+AZB551FYgWJDDOm8hDC8vHJK019gkHaAhmk3mXkDTJ
> jVMyxbWeHObK0Ij9GR2mQwaK5EsHbRoNgPk5pJYQkzlVUoCkNJIRdlvfNreuPuIA
> g6gWvs/Q1RL73M3Q0TFAKH+tSWnIvPbU8QGzAroPPrJBID83eHX19XMrh+0x9s0w
> E5SIcNFww7UACCAdE9uyZmv0opnBcEwdfborwwiA6p6VOFKC26V2p1pK3ikhPu9t
> GeCJbntjuQ0Oz2CY0FDzbuNCOyeXIZFZ2bZFco0tRNYStYKnQAcIle49Tdyh2+gR
> 2S5jsqgwIrD378HhUGGD1W+ce/3VV157bcBW9pTr+SiqYlE9F0X1ZuW8N5M9Hhh6
> yq/Ac7QP9D2XoZmBA+owyggP9JaCu1rsgSJVmJbmHEMGTfBhY/VozwrzAc4/2QOR
> 2LvlHJ2Mx5shgMqDQcrdP0A/tPQjnbPL5dzeEW6XZciq6nKdAyQYILhCK7Ur2w77
> bKvGbfdCxfPtmjOTshXVY/dbnHZUX/a7SJ3u3bxxe/jWCsVwcjy4cYf0dVtaU48P
> c40+YCDALswHErMCGKoGm+MATNkZDa/f3Nq8vrm9s3lljPkMExlH6TJCIsNcUyBO
> YCUEQ/Gds2evDK8QLp49+2j44iRnTSYjkwRXYyCh95H7ZsrG4ErgOJANqlxHBI59
> wAjGgwgSciBzVSgJngAc9oRVHCUXYz0egUK0GWWrY/iFyc4y5fi2zAXlTQ0APNJN
> WIXANV+5Ec9R+8+ZQ4wbBA1Pm0XW1ow7Mo/Q++/TqbBw7dLt0falneG3Nkebt25t
> 30BHTKJznDQ6sJzW6WvYapszxWUnfYdP4dsKrb/x2Gk8nufj7b42ncePnI999xZj
> tRsxnQmmeiAMLRtza76gl9owMLoB8ybdU6ZxPBw4VMlayz/Ox8GcmEcmpp0X+aVD
> BRrOwxLrCKIjozwJepYfm+VuyHIERQXsL7rmAUMWqoJ9Yd5E6tbXd25cubG+Dkku
> qENmrY40H0AXbQeFyZhBuo2UQ2VyqWgHU66lGY/4/ALEI3Tjp1zrBhMpzaBWpHOH
> VtynSxXXBOoM7uUy7B3y9Yz9wagfggGOlKHBBa9mpeG65aGb7wCxyEzR+PvhNcZi
> QMxjLTzZAV0ojFrFctk4GN07G7d2MMtANfxyoadP+USkJgx3ruQYW/YCobBmFl84
> ER+BN4FQ+IvXvgiAjdVeKhwcKfCaJMPrTifcKJHx1BgAU+QSWBOUKr940wwqarMX
> iSZKylFjYY46oIb4aoUtBA6HA9dwrWIs8Ise8zQmhLWLmQwu3kZPY4pdeHQq+X5z
> fOlksvTlk6eO/+v3b7/xg4/++3L60icXFj8NfP4F/jFgKTnx0mJl/qulfydp5+d/
> +/FbH/2l/vPVvz78w+Uf2Qu/ePHkt3d+c/xnX/j4q6f+eGzpnx/0/v7gd7/90omv
> nHjh4cNvfrz1vZcfvP2Tkw+OvfnhZ5fnW0v/Aw==
> =Up5X
> -----END PGP MESSAGE-----
> ```

### UEFI Project
I've been working on and off on my own [GNU-EFI analog](https://github.com/NotsoanoNimus/uefi.c3l) built exclusively in [C3](https://c3-lang.org/), and linked to resulting EFI applications with a little help from our friend `clang`. I'll show the linker command as work on this project progresses, of course, since it does essentially nothing right now.

Attempting to recreate _gnuefi_ has been - needless to say - a challenge so far. There are multiple things working against me constantly:
- Working with a new programming language
  - _Meaning there are quite a few bugs to work out still and I never know where to point my finger for any given issue_
- Needing to stage the linking separately from the compilation of the objects
- Forming my own independent "architecture" and runtime for UEFI applications to use
- Attempting to integrate C3's standard library into the mix

#### @weak
Enter the first and primary issue of the day: the `@weak` symbol.

###### lib/std/libc/libc.c3
```c
module libc @if(env::NO_LIBC);
// ...
fn void* malloc(usz size) @weak @extern("malloc") @nostrip
{
	unreachable("malloc unavailable");
}
fn void* calloc(usz count, usz size) @weak @extern("calloc") @nostrip
{
	unreachable("calloc unavailable");
}
fn void* free(void*) @weak @extern("free")
{
	unreachable("free unavailable");
}
fn void* realloc(void* ptr, usz size) @weak @extern("realloc") @nostrip
{
	unreachable("realloc unavailable");
}
```

Notice the attributes to the right? These are [weak declarations](https://en.wikipedia.org/wiki/Weak_symbol) for expected _libc_ memory functions which attempt to point themselves to other externally-defined symbols by the same name.

This means if your implementation has its own `malloc`, `calloc`, etc. export, then it should overwrite these symbols upon linking.

However, it seems C3's `@weak` attribute isn't properly passing this property onto the generated `windows-x64` target executable. This causes a slew of `duplicate symbol` errors upon linking. Indeed, more research seems to point to _weak_ symbols being more exclusive - or at the very least native - to the ELF executable format.

Nonetheless, a [GitHub Issue](https://github.com/c3lang/c3c/issues/2396) has been created to hopefully remediate the issue at the language level. We'll see what happens!

#### Thread-Local Storage
I'm only just now scratching the surface of this, but... [Thread-Local Storage](https://stackoverflow.com/questions/35692188/what-is-thread-local-storage-why-we-need-it) is an obscure demon that's haunting my ability to link the C3 standard library with my EFI applications.

Why might I care about this for a UEFI application, you might ask.

Well, if one would like to use the C3 standard library with `NO_LIBC`, one must be able to use the native (i.e., non-POSIX) threading interface, which is essentially unimplemented and returns mostly `NOT_IMPLEMENTED` faults.

But even if I explicitly **DID NOT** care about multiprocessing with UEFI and explicitly opted out, the presence of `tlocal` storage specifiers on variables like `_errno_c3` requires at least a dummy declaration of a `_tls_index` symbol.

###### lib/std/libc/os/errno.c3
```c
module libc::os @if(env::NO_LIBC || !env::HAS_NATIVE_ERRNO);

tlocal int _errno_c3 = 0;

fn void errno_set(int err) => _errno_c3 = err;
fn int errno() => _errno_c3;
```

Right, this can't be changed at the moment, for obvious reasons: the last thing I'm going to commit to doing is change the standard library for the sake of UEFI alone.

This has been filed into my ==TODO== list to learn more about, for sure.

### Summary
After these two woes, my output today was abysmal. Almost no code was created toward anything, because the whole time was spent futzing around with duplicate symbols and missing C runtime (CRT) features.

Hoping for a fresh start tomorrow, and to actually progress this C3-based framework (and thus bootloader) a bit. I'll start moving in this direction even if there is no movement on getting the C3 standard library to function.

See you tomorrow!